def update(inp_str):
    return list(map(int, inp_str.split('#')))


def decode(inp_str):
    inp_str[1] = update(inp_str[1])[::-1]
    for i in inp_str[1]:
        inp_str[0] = str(int(inp_str[0], i))
    return inp_str[0]


def up(inp_str, system):
    inp_str = int(inp_str)
    system -= 0
    alphabet = list('0123456789abcdefghijklmnopqrstuvwxyz')
    out_str = ""
    while inp_str > 0:
        x = inp_str % system
        out_str += alphabet[x]
        inp_str = inp_str // system
    return out_str[::-1]


def encode(inp_str):
    inp_str[1] = update(inp_str[1])
    for i in inp_str[1]:
        inp_str[0] = up(int(inp_str[0]), i)
    return inp_str[0]


string = input("Enter a string: ")
key = input("KEY (1#2#3#4#...): ")
mode = input("MODE (en - Encode or de - Decode): ")
if mode == "en":
    print("Out string:", encode([string, key]))
    print("Key:", key)
elif mode == 'de':
    print("Out string:", decode([string, key]))
